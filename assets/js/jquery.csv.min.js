RegExp.escape=function(r){return r.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")},function(){"use strict";var r;r="undefined"!=typeof jQuery&&jQuery?jQuery:{},r.csv={defaults:{separator:",",delimiter:'"',headers:!0},hooks:{castToScalar:function(r,e){var a=/\./;if(isNaN(r))return r;if(a.test(r))return parseFloat(r);var t=parseInt(r);return isNaN(t)?null:t}},parsers:{parse:function(r,e){function a(){if(l=0,u="",e.start&&e.state.rowNum<e.start)return i=[],e.state.rowNum++,void(e.state.colNum=1);if(void 0===e.onParseEntry)n.push(i);else{var r=e.onParseEntry(i,e.state);!1!==r&&n.push(r)}i=[],e.end&&e.state.rowNum>=e.end&&(c=!0),e.state.rowNum++,e.state.colNum=1}function t(){if(void 0===e.onParseValue)i.push(u);else if(e.headers&&1===e.state.rowNum)i.push(u);else{var r=e.onParseValue(u,e.state);!1!==r&&i.push(r)}u="",l=0,e.state.colNum++}var o=e.separator,s=e.delimiter;e.state.rowNum||(e.state.rowNum=1),e.state.colNum||(e.state.colNum=1);var n=[],i=[],l=0,u="",c=!1,f=RegExp.escape(o),d=RegExp.escape(s),m=/(D|S|\r\n|\n|\r|[^DS\r\n]+)/,p=m.source;return p=p.replace(/S/g,f),p=p.replace(/D/g,d),m=new RegExp(p,"gm"),r.replace(m,function(r){if(!c)switch(l){case 0:if(r===o){u+="",t();break}if(r===s){l=1;break}if(/^(\r\n|\n|\r)$/.test(r)){t(),a();break}u+=r,l=3;break;case 1:if(r===s){l=2;break}u+=r,l=1;break;case 2:if(r===s){u+=r,l=1;break}if(r===o){t();break}if(/^(\r\n|\n|\r)$/.test(r)){t(),a();break}throw Error("CSVDataError: Illegal State [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]");case 3:if(r===o){t();break}if(/^(\r\n|\n|\r)$/.test(r)){t(),a();break}if(r===s)throw Error("CSVDataError: Illegal Quote [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]");throw Error("CSVDataError: Illegal Data [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]");default:throw Error("CSVDataError: Unknown State [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]")}}),0!==i.length&&(t(),a()),n},splitLines:function(e,a){function t(){if(i=0,a.start&&a.state.rowNum<a.start)return l="",void a.state.rowNum++;if(void 0===a.onParseEntry)n.push(l);else{var r=a.onParseEntry(l,a.state);!1!==r&&n.push(r)}l="",a.end&&a.state.rowNum>=a.end&&(u=!0),a.state.rowNum++}if(e){a=a||{};var o=a.separator||r.csv.defaults.separator,s=a.delimiter||r.csv.defaults.delimiter;a.state=a.state||{},a.state.rowNum||(a.state.rowNum=1);var n=[],i=0,l="",u=!1,c=RegExp.escape(o),f=RegExp.escape(s),d=/(D|S|\n|\r|[^DS\r\n]+)/,m=d.source;return m=m.replace(/S/g,c),m=m.replace(/D/g,f),d=new RegExp(m,"gm"),e.replace(d,function(r){if(!u)switch(i){case 0:if(r===o){l+=r,i=0;break}if(r===s){l+=r,i=1;break}if("\n"===r){t();break}if(/^\r$/.test(r))break;l+=r,i=3;break;case 1:if(r===s){l+=r,i=2;break}l+=r,i=1;break;case 2:var e=l.substr(l.length-1);if(r===s&&e===s){l+=r,i=1;break}if(r===o){l+=r,i=0;break}if("\n"===r){t();break}if("\r"===r)break;throw Error("CSVDataError: Illegal state [Row:"+a.state.rowNum+"]");case 3:if(r===o){l+=r,i=0;break}if("\n"===r){t();break}if("\r"===r)break;if(r===s)throw Error("CSVDataError: Illegal quote [Row:"+a.state.rowNum+"]");throw Error("CSVDataError: Illegal state [Row:"+a.state.rowNum+"]");default:throw Error("CSVDataError: Unknown state [Row:"+a.state.rowNum+"]")}}),""!==l&&t(),n}},parseEntry:function(r,e){function a(){if(void 0===e.onParseValue)s.push(i);else{var r=e.onParseValue(i,e.state);!1!==r&&s.push(r)}i="",n=0,e.state.colNum++}var t=e.separator,o=e.delimiter;e.state.rowNum||(e.state.rowNum=1),e.state.colNum||(e.state.colNum=1);var s=[],n=0,i="";if(!e.match){var l=RegExp.escape(t),u=RegExp.escape(o),c=/(D|S|\n|\r|[^DS\r\n]+)/,f=c.source;f=f.replace(/S/g,l),f=f.replace(/D/g,u),e.match=new RegExp(f,"gm")}return r.replace(e.match,function(r){switch(n){case 0:if(r===t){i+="",a();break}if(r===o){n=1;break}if("\n"===r||"\r"===r)break;i+=r,n=3;break;case 1:if(r===o){n=2;break}i+=r,n=1;break;case 2:if(r===o){i+=r,n=1;break}if(r===t){a();break}if("\n"===r||"\r"===r)break;throw Error("CSVDataError: Illegal State [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]");case 3:if(r===t){a();break}if("\n"===r||"\r"===r)break;if(r===o)throw Error("CSVDataError: Illegal Quote [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]");throw Error("CSVDataError: Illegal Data [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]");default:throw Error("CSVDataError: Unknown State [Row:"+e.state.rowNum+"][Col:"+e.state.colNum+"]")}}),a(),s}},helpers:{collectPropertyNames:function(r){var e=[],a=[],t=[];for(e in r)for(a in r[e])r[e].hasOwnProperty(a)&&t.indexOf(a)<0&&"function"!=typeof r[e][a]&&t.push(a);return t}},toArray:function(e,a,t){if(void 0!==a&&"function"==typeof a){if(void 0!==t)return console.error("You cannot 3 arguments with the 2nd argument being a function");t=a,a={}}a=void 0!==a?a:{};var o={};o.callback=void 0!==t&&"function"==typeof t&&t,o.separator="separator"in a?a.separator:r.csv.defaults.separator,o.delimiter="delimiter"in a?a.delimiter:r.csv.defaults.delimiter;var s=void 0!==a.state?a.state:{};a={delimiter:o.delimiter,separator:o.separator,onParseEntry:a.onParseEntry,onParseValue:a.onParseValue,state:s};var n=r.csv.parsers.parseEntry(e,a);if(!o.callback)return n;o.callback("",n)},toArrays:function(e,a,t){if(void 0!==a&&"function"==typeof a){if(void 0!==t)return console.error("You cannot 3 arguments with the 2nd argument being a function");t=a,a={}}a=void 0!==a?a:{};var o={};o.callback=void 0!==t&&"function"==typeof t&&t,o.separator="separator"in a?a.separator:r.csv.defaults.separator,o.delimiter="delimiter"in a?a.delimiter:r.csv.defaults.delimiter;var s=[];if(a={delimiter:o.delimiter,separator:o.separator,onPreParse:a.onPreParse,onParseEntry:a.onParseEntry,onParseValue:a.onParseValue,onPostParse:a.onPostParse,start:a.start,end:a.end,state:{rowNum:1,colNum:1}},void 0!==a.onPreParse&&(e=a.onPreParse(e,a.state)),s=r.csv.parsers.parse(e,a),void 0!==a.onPostParse&&(s=a.onPostParse(s,a.state)),!o.callback)return s;o.callback("",s)},toObjects:function(e,a,t){if(void 0!==a&&"function"==typeof a){if(void 0!==t)return console.error("You cannot 3 arguments with the 2nd argument being a function");t=a,a={}}a=void 0!==a?a:{};var o={};o.callback=void 0!==t&&"function"==typeof t&&t,o.separator="separator"in a?a.separator:r.csv.defaults.separator,o.delimiter="delimiter"in a?a.delimiter:r.csv.defaults.delimiter,o.headers="headers"in a?a.headers:r.csv.defaults.headers,a.start="start"in a?a.start:1,o.headers&&a.start++,a.end&&o.headers&&a.end++;var s=[],n=[];a={delimiter:o.delimiter,separator:o.separator,onPreParse:a.onPreParse,onParseEntry:a.onParseEntry,onParseValue:a.onParseValue,onPostParse:a.onPostParse,start:a.start,end:a.end,state:{rowNum:1,colNum:1},match:!1,transform:a.transform};var i={delimiter:o.delimiter,separator:o.separator,start:1,end:1,state:{rowNum:1,colNum:1},headers:!0};void 0!==a.onPreParse&&(e=a.onPreParse(e,a.state));var l=r.csv.parsers.splitLines(e,i),u=r.csv.toArray(l[0],i);s=r.csv.parsers.splitLines(e,a),a.state.colNum=1,a.state.rowNum=u?2:1;for(var c=0,f=s.length;c<f;c++){for(var d=r.csv.toArray(s[c],a),m={},p=0;p<u.length;p++)m[u[p]]=d[p];void 0!==a.transform?n.push(a.transform.call(void 0,m)):n.push(m),a.state.rowNum++}if(void 0!==a.onPostParse&&(n=a.onPostParse(n,a.state)),!o.callback)return n;o.callback("",n)},fromArrays:function(e,a,t){if(void 0!==a&&"function"==typeof a){if(void 0!==t)return console.error("You cannot 3 arguments with the 2nd argument being a function");t=a,a={}}a=void 0!==a?a:{};var o={};o.callback=void 0!==t&&"function"==typeof t&&t,o.separator="separator"in a?a.separator:r.csv.defaults.separator,o.delimiter="delimiter"in a?a.delimiter:r.csv.defaults.delimiter;var s,n,i,l,u="";for(i=0;i<e.length;i++){for(s=e[i],n=[],l=0;l<s.length;l++){var c=void 0===s[l]||null===s[l]?"":s[l].toString();c.indexOf(o.delimiter)>-1&&(c=c.replace(new RegExp(o.delimiter,"g"),o.delimiter+o.delimiter));var f="\n|\r|S|D";f=f.replace("S",o.separator),f=f.replace("D",o.delimiter),c.search(f)>-1&&(c=o.delimiter+c+o.delimiter),n.push(c)}u+=n.join(o.separator)+"\n"}if(!o.callback)return u;o.callback("",u)},fromObjects:function(e,a,t){if(void 0!==a&&"function"==typeof a){if(void 0!==t)return console.error("You cannot 3 arguments with the 2nd argument being a function");t=a,a={}}a=void 0!==a?a:{};var o={};if(o.callback=void 0!==t&&"function"==typeof t&&t,o.separator="separator"in a?a.separator:r.csv.defaults.separator,o.delimiter="delimiter"in a?a.delimiter:r.csv.defaults.delimiter,o.headers="headers"in a?a.headers:r.csv.defaults.headers,o.sortOrder="sortOrder"in a?a.sortOrder:"declare",o.manualOrder="manualOrder"in a?a.manualOrder:[],o.transform=a.transform,"string"==typeof o.manualOrder&&(o.manualOrder=r.csv.toArray(o.manualOrder,o)),void 0!==o.transform){var s,n=e;for(e=[],s=0;s<n.length;s++)e.push(o.transform.call(void 0,n[s]))}var i,l,u=r.csv.helpers.collectPropertyNames(e);if("alpha"===o.sortOrder&&u.sort(),o.manualOrder.length>0){var c,f=[].concat(o.manualOrder);for(c=0;c<u.length;c++)f.indexOf(u[c])<0&&f.push(u[c]);u=f}var d,m=[];for(o.headers&&m.push(u),i=0;i<e.length;i++){for(l=[],c=0;c<u.length;c++)d=u[c],d in e[i]&&"function"!=typeof e[i][d]?l.push(e[i][d]):l.push("");m.push(l)}return r.csv.fromArrays(m,a,o.callback)}},r.csvEntry2Array=r.csv.toArray,r.csv2Array=r.csv.toArrays,r.csv2Dictionary=r.csv.toObjects,"undefined"!=typeof module&&module.exports&&(module.exports=r.csv)}.call(this);